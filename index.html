<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Browser</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    /* Tabs row */
    #tabs {
      display: flex;
      align-items: center;
      background: #222;
      color: white;
      padding: 4px;
      overflow-x: auto;
      white-space: nowrap;
    }

    .tab {
      display: flex;
      align-items: center;
      background: #333;
      padding: 6px 12px;
      margin-right: 4px;
      border-radius: 6px 6px 0 0;
      cursor: pointer;
    }

    .tab.active {
      background: #555;
      font-weight: bold;
    }

    .tab span {
      margin-right: 6px;
    }

    .close-btn {
      border: none;
      background: none;
      color: white;
      font-size: 14px;
      cursor: pointer;
    }

    #addTabBtn {
      background: #444;
      border: none;
      color: white;
      font-size: 16px;
      padding: 6px 10px;
      cursor: pointer;
      border-radius: 50%;
    }

    /* Address bar */
    #addressBar {
      width: 100%;
      padding: 8px;
      border: none;
      outline: none;
      font-size: 14px;
      border-top: 1px solid #ccc;
      box-sizing: border-box;
    }

    /* Content (iframe area) */
    #content {
      flex: 1;
      display: flex;
      background: #f0f0f0;
    }

    #content iframe {
      border: none;
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <!-- Tabs row -->
  <div id="tabs"></div>

  <!-- Address bar -->
  <input id="addressBar" type="text" placeholder="Enter URL or search..."
         onkeydown="if(event.key==='Enter'){navigateToAddress();}">

  <!-- Iframe content -->
  <div id="content"></div>

  <!-- Your script (unchanged) -->
  <script>
    let tabs = [];
    let activeTabId = null;

    function createTab() {
      const id = Date.now() + Math.random();
      const tab = { id, title: 'New Tab', url: 'about:blank' };
      tabs.push(tab);
      renderTabs();
      setActiveTab(id);
    }

    function closeTab(id) {
      tabs = tabs.filter(t => t.id !== id);
      if (activeTabId === id) {
        if (tabs.length > 0) {
          setActiveTab(tabs[tabs.length -1].id);
        } else {
          document.getElementById('content').innerHTML = '';
          activeTabId = null;
          renderTabs();
        }
      } else {
        renderTabs();
      }
    }

    function setActiveTab(id) {
      activeTabId = id;
      const tab = tabs.find(t => t.id === id);
      if (tab) {
        loadContent(tab);
        document.getElementById('addressBar').value = tab.url === 'about:blank' ? '' : tab.url;
      }
      highlightActiveTab();
    }

    function highlightActiveTab() {
      document.querySelectorAll('.tab').forEach(t => {
        if (parseFloat(t.dataset.id) === activeTabId) {
          t.classList.add('active');
        } else {
          t.classList.remove('active');
        }
      });
    }

    function renderTabs() {
      const container = document.getElementById('tabs');
      container.innerHTML = '';

      tabs.forEach(t => {
        const tabEl = document.createElement('div');
        tabEl.className = 'tab';
        tabEl.dataset.id = t.id;
        if (t.id === activeTabId) tabEl.classList.add('active');

        const span = document.createElement('span');
        span.textContent = t.title;
        tabEl.appendChild(span);

        const closeBtn = document.createElement('button');
        closeBtn.innerHTML = 'Ã—';
        closeBtn.className = 'close-btn';
        closeBtn.onclick = (e) => { e.stopPropagation(); closeTab(t.id); };
        tabEl.appendChild(closeBtn);

        tabEl.onclick = () => setActiveTab(t.id);
        container.appendChild(tabEl);
      });

      const plusBtn = document.createElement('button');
      plusBtn.id = 'addTabBtn';
      plusBtn.innerHTML = '+';
      plusBtn.title = 'New Tab';
      plusBtn.onclick = createTab;
      container.appendChild(plusBtn);
    }

    function loadContent(tab) {
      const container = document.getElementById('content');
      container.innerHTML = '';
      if (tab.url && tab.url !== 'about:blank') {
        const iframe = document.createElement('iframe');
        iframe.src = `/s/embed.html#${tab.url}`;
        container.appendChild(iframe);
      }
    }

    function navigateToAddress() {
      const input = document.getElementById('addressBar');
      let url = input.value.trim();
      if (!url) return;

      if (!url.startsWith('http://') && !url.startsWith('https://')) {
        if (url.includes('.')) {
          url = 'https://' + url;
        } else {
          url = 'https://search.brave.com/search?q=' + encodeURIComponent(url);
        }
      }

      if (activeTabId === null && tabs.length === 0) {
        createTab();
      }
      const tab = tabs.find(t => t.id === activeTabId);
      if (tab) {
        tab.url = url;
        tab.title = (() => { try { return new URL(url).hostname; } catch { return 'Search'; } })();
        loadContent(tab);
        renderTabs();
      }
    }

    createTab();
  </script>
</body>
</html>
